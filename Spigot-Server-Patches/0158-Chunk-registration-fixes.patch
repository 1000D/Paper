From 9cac6b05436fbabbca09b7f6940691189aa6767a Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Tue, 10 Oct 2017 16:33:58 -0400
Subject: [PATCH] Chunk registration fixes

World checks and the Chunk Add logic are inconsistent on how Y > 256, < 0, is treated

Keep them consistent

diff --git a/src/main/java/net/minecraft/world/World.java b/src/main/java/net/minecraft/world/World.java
index 7d86f5b..e228516 100644
--- a/src/main/java/net/minecraft/world/World.java
+++ b/src/main/java/net/minecraft/world/World.java
@@ -1768,7 +1768,7 @@ public abstract class World implements IBlockAccess {
             }
 
             int i = MathHelper.floor(entityIn.posX / 16.0D);
-            int j = MathHelper.floor(entityIn.posY / 16.0D);
+            int j = Math.min(15, Math.max(0, MathHelper.floor(entityIn.posY / 16.0D))); // Paper - stay consistent with chunk add/remove behavior
             int k = MathHelper.floor(entityIn.posZ / 16.0D);
 
             if (!entityIn.addedToChunk || entityIn.chunkCoordX != i || entityIn.chunkCoordY != j || entityIn.chunkCoordZ != k) {
-- 
2.14.2.windows.2

